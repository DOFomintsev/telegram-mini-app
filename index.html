<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Premium Shop</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root {
  --bg: var(--tg-theme-bg-color, #f2f2f7);
  --text: var(--tg-theme-text-color, #000);
  --secondary: var(--tg-theme-hint-color, #8e8e93);
  --card: var(--tg-theme-secondary-bg-color, #ffffff);
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg);
  color: var(--text);
}

.container {
  padding: 24px 20px 40px;
}

h1 {
  font-size: 28px;
  font-weight: 600;
  margin-bottom: 28px;
}

.card {
  background: var(--card);
  padding: 20px;
  border-radius: 22px;
  margin-bottom: 16px;
  font-size: 17px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.05);
  transition: 0.15s ease;
}

.card:active {
  transform: scale(0.97);
}

.back {
  margin-bottom: 20px;
  font-size: 15px;
  color: var(--secondary);
  cursor: pointer;
}

.arrow {
  color: var(--secondary);
}
</style>
</head>

<body>
<div class="container" id="app">
  <h1>Загрузка...</h1>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

// ⚠️ ВСТАВЬ СЮДА СВОЮ CSV ССЫЛКУ
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1-JYl4b-6H_iWvBS2Zsez1K1DPx35iBUCCPPRiSrVY7o/export?format=csv";

const app = document.getElementById("app");
let data = {};

async function loadData() {
  const response = await fetch(SHEET_URL);
  const text = await response.text();
  const rows = text.split("\n").slice(1);

  rows.forEach(row => {
    const [category, price, link] = row.split(",");
    if (!data[category]) data[category] = [];
    data[category].push({ price, link });
  });

  showCategories();
}

function showCategories() {
  app.innerHTML = "<h1>Категории</h1>";
  Object.keys(data).forEach(category => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<span>${category}</span><span class="arrow">›</span>`;
    div.onclick = () => showPrices(category);
    app.appendChild(div);
  });
}

function showPrices(category) {
  app.innerHTML = `
    <div class="back" onclick="showCategories()">← Назад</div>
    <h1>${category}</h1>
  `;

  data[category].forEach(item => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<span>${item.price}</span><span class="arrow">↗</span>`;
    div.onclick = () => tg.openLink(item.link);
    app.appendChild(div);
  });
}

loadData();
</script>
</body>
</html>
